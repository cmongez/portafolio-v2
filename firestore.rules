rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // ===========================================
    // COLECCIÓN: projects (Legacy Projects)
    // ===========================================
    // Política: Solo lectura pública
    // Escritura: Solo desde Firebase Console
    // ===========================================
    match /projects/{document=**} {
      // ✅ Permitir lectura a cualquier usuario (público)
      allow read: if true;
      
      // ❌ Prohibir escritura desde el cliente
      // Para agregar/editar proyectos, usar Firebase Console
      allow write: if false;
    }
    
    // ===========================================
    // REGLAS POR DEFECTO (Otras colecciones)
    // ===========================================
    // Si en el futuro añades más colecciones,
    // estas estarán bloqueadas por defecto
    // ===========================================
    match /{document=**} {
      allow read, write: if false;
    }
  }
}

// ===========================================
// NOTAS DE SEGURIDAD
// ===========================================
//
// 1. Variables NEXT_PUBLIC_* son PÚBLICAS por diseño
//    - Firebase requiere estas keys en el frontend
//    - NO son secretas (se envían al navegador del usuario)
//    - La seguridad real viene de estas reglas
//
// 2. App Check (Recomendado)
//    - Activa reCAPTCHA v3 en Firebase Console → App Check
//    - Protege contra bots y abuse incluso con API keys públicas
//
// 3. Para desarrollo local
//    - Puedes usar Firebase Emulator Suite
//    - No consume cuota de Firestore
//
// 4. Monitoreo
//    - Revisa Firebase Console → Usage para detectar anomalías
//    - Configura alertas de cuota en Google Cloud Console
//
// ===========================================
// CÓMO APLICAR ESTAS REGLAS
// ===========================================
//
// Opción 1: Firebase Console (Manual)
//   1. Ve a Firebase Console → Firestore Database
//   2. Click en tab "Rules"
//   3. Copia y pega este archivo
//   4. Click "Publish"
//
// Opción 2: Firebase CLI (Automático)
//   1. Instala: npm install -g firebase-tools
//   2. Login: firebase login
//   3. Init: firebase init firestore
//   4. Copia estas reglas a firestore.rules
//   5. Deploy: firebase deploy --only firestore:rules
//
// ===========================================
